# デバッグパネル使用ガイド

## 概要
デバッグパネルは、Twitchのチャンネルポイント報酬（カスタムリワード）をエミュレートする機能です。
実際のTwitch APIを使用せずに、FAX送信の動作をテストできます。

## 起動手順

### 1. バックエンドの起動
```bash
# twitch-overlay ディレクトリで実行
DRY_RUN_MODE=true go run ./cmd/twitch-overlay
```

### 2. フロントエンドの起動
新しいターミナルで：
```bash
# web ディレクトリに移動
cd web

# 開発サーバーを起動
bun run dev
```

### 3. デバッグパネルへアクセス
ブラウザで以下のURLにアクセス：
```
http://localhost:5173/?debug=true
```

## 使用方法

1. 画面右下の「Debug Panel」ボタンをクリック
2. 以下の情報を入力：
   - **ユーザー名**: FAXを送信するユーザー名
   - **リワードタイトル**: チャンネルポイント報酬の名前（例：「FAX送信」）
   - **ユーザー入力**: FAXに送信したいメッセージ
3. 「チャンネルポイントを使用」ボタンをクリック

## 動作の仕組み

1. デバッグパネルから送信されたデータは `/debug/channel-points` エンドポイントに送信されます
2. バックエンドで `HandleChannelPointsCustomRedemptionAdd` と同じ処理が実行されます
3. メッセージは「🎉チャネポ [リワードタイトル] [ユーザー入力]」の形式で生成されます
4. `output.PrintOut` が呼び出され、FAXとして処理されます
5. SSE（Server-Sent Events）経由でフロントエンドに通知され、画面にアニメーション表示されます

## トラブルシューティング

### 「デバッグチャンネルポイントの送信に失敗しました」エラーが出る場合

1. **バックエンドが起動しているか確認**
   ```bash
   lsof -i :8080
   ```
   出力がない場合は、バックエンドが起動していません。

2. **フロントエンドの開発サーバーを再起動**
   - Ctrl+C で停止してから `bun run dev` で再起動

3. **テストスクリプトで確認**
   ```bash
   ./test-debug.sh
   ```

### ポート競合の場合

別のプロセスがポートを使用している場合：
```bash
# ポート8080を使用しているプロセスを確認
lsof -i :8080

# ポート5173を使用しているプロセスを確認
lsof -i :5173
```

## 注意事項

- `DRY_RUN_MODE=true` を設定すると、実際のプリンターへの印刷は行われません
- デバッグパネルは `?debug=true` パラメータがある場合のみ表示されます
- バックエンドとフロントエンドの両方が起動している必要があります