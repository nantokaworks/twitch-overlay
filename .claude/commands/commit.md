---
title: "Gitコミットタスク"
read_only: true
type: "command"
---

# 新しいgitコミットを作成

## 🚨 重要な前提事項

- **勝手に git add しない**
- このタスクはコミットが許可される2つのコマンドのうちの1つです（もう1つは commit! です）
- ステージングされたファイルを取得し、コミットメッセージを提案し、常に確認を求め、明示的な承認後にのみコミットを作成します
- **絵文字を先頭に付けたコミットメッセージ**を作成します
  - **絵文字の選択基準**：
    - 🐛 :bug: バグ修正
    - 🎈 :balloon: 文字列変更や軽微な修正
    - 👍 :+1: 機能改善
    - ✨ :sparkles: 部分的な機能追加
    - 🎉 :tada: 盛大に祝うべき大きな機能追加
    - ♻️ :recycle: リファクタリング
    - 🚿 :shower: 不要な機能・使われなくなった機能の削除
    - 💚 :green_heart: テストやCIの修正・改善
    - 👕 :shirt: Lintエラーの修正やコードスタイルの修正
    - 🚀 :rocket: パフォーマンス改善
    - 🆙 :up: 依存パッケージなどのアップデート
    - 🔒 :lock: 新機能の公開範囲の制限
    - 👮 :cop: セキュリティ関連の改善
    - 🔧 :wrench: 設定関連変更
    - 📝 :memo: ドキュメントの整理
    - 🚧 :construction: 作業中
- コミットメッセージの形式は影響を受けるファイルによって異なります：
  - Webアプリケーション変更（例：web/tower, web/labo）：`:emoji: [tower] 変更内容の説明`
  - Goサービス変更（例：cmd/tower, cmd/worker）：`:emoji: [cmd/tower] 変更内容の説明`
  - API/Protobuf変更：`:emoji: [api] 変更内容の説明`
  - データベース/SQLC変更：`:emoji: [db] 変更内容の説明`
  - ルートまたは特殊なディレクトリの設定ファイルの場合：
    - Taskfile.yml：`:emoji: [task] 変更内容の説明`
    - Docker/開発環境：`:emoji: [dev] 変更内容の説明`
    - ESLint設定：`:emoji: [eslint] 変更内容の説明`
    - TypeScript設定：`:emoji: [typescript] 変更内容の説明`
    - Git関連ファイル：`:emoji: [gitignore] 変更内容の説明`
    - Claude関連ファイル（例：CLAUDE.mdや.claudeフォルダ内の変更）：`:emoji: [claude] 変更内容の説明`
    - その他のルート設定：角括弧内に適切な記述子を使用
  - 複数のパッケージにまたがる機能の場合：機能名をスコープとして使用
  - 黄金律：パッケージ変更にはパッケージ名を使用し、それ以外は機能/ディレクトリスコープを使用
  - 変更の80%以上が単一の機能に集中している場合、メインパッケージのみを記載し、関連する小さな変更は無視
  - 説明は日本語で記載（プロジェクトの慣例に従う）
  - 説明は簡潔に、何が変更されたかを説明する
  - コミットメッセージはステージングされたファイルのみに基づく
- 常に番号付きリストで最低5つのメッセージオプションを提供し、私が1つを選ぶか別のオプションをリクエストします
- ファイルのステージングについて決して尋ねないでください - コミットしたいファイルはステージングされていないものも含めてすべての変更ファイルです。
- 角括弧内のスコープは、すべての提案メッセージで一貫している必要があります - 変更されたファイルに基づく固定ルールであり、オプション間で変えるものではありません
- コミットメッセージを提案する際は、`git log -n 100 --oneline`を使用して最近のコミットメッセージを確認し、フォーマットとスタイル（特に絵文字の使用）の参考にします
- 提案されたコミットメッセージをオレンジ色のテキストでフォーマットし、ターミナルで読みやすくします
- 私から明示的な確認なしに`git commit -m`を実行しないでください
- 私が明示的に確認またはコミットメッセージを修正した後にのみ、`git commit -m "message"`を実行してください
- 変更をプッシュできると伝えた場合、許可を求めずに直接`git push`を実行できます
- Claude共著フッターをコミットに追加しないでください
- **必ず絵文字を先頭に付ける**
- ステージングされていないファイルはステージングする

## 良いコミットメッセージの例（photo-sta-nexプロジェクト）

- `🐛 [tower] 初回レンダー時のHeaderコンポーネントでのラボ名取得問題を修正`
- `✨ [labo] 現像所管理画面に新規注文通知機能を追加`
- `♻️ [cmd/worker] 画像処理ワーカーのパフォーマンス最適化`
- `🎈 [snap] 写真アップロード時のエラーメッセージを日本語化`
- `🔧 [api] Protocol Buffersでの新しい注文管理サービス定義`
- `👍 [db] SQLC使用でラボ別価格テーブルのクエリ最適化`
- `🆙 [tower] React 19.1.0およびReact Router v7.5.1へアップデート`
- `💚 [camera] Vitestテストのhappy-dom設定を修正`
- `🚿 [photo-sta] 使用されていないRemixローダー関数を削除`
- `📝 [claude] CLAUDE.mdにTower SPA移行の詳細ドキュメントを追加`

## プリコミットチェック

- プリコミットチェックはメインのコミットアクションの前に実行されます
- トリガー条件を満たすプリコミットチェックのみを実行します
- プリコミットチェックが失敗した場合、すぐにプロセス全体（プリコミットとコミットアクションの両方）を中止します
- エラーメッセージを表示し、問題が修正されるまで続行しません

### プリコミットチェック：コードガイドラインの遵守

- **トリガー条件**：TypeScript（.ts）またはReact（.tsx）ファイルを編集する時
- **チェック内容**：変更が適切なコードガイドラインに準拠していることを確認
- **具体的なチェック**：
  - PrettierとESLintによるチェックとフォーマット
- **失敗時の動作**：
  - コミットプロセスを中止し、コードガイドライン違反に関する詳細なエラーメッセージを表示
  - 違反している特定のガイドラインを表示
  - ガイドラインに基づいて一般的な違反の修正を提案
  - ユーザーが問題を修正するまでコミットを続行しない
